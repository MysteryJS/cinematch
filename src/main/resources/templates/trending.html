<!DOCTYPE html>
<html lang="el">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trending Movies</title>
    <link rel="stylesheet" href="/trending.css">
</head>

<body>

<nav class="navbar">
    <div class="nav-container">
        <a href="index.html" class="logo-link" title="CineMatch">
            <img src="/logo.png" alt="CineMatch logo" class="logo-img">
        </a>

        <ul class="nav-menu">
            <li><a href="/" data-page="home" class="nav-link">Home</a></li>
            <li><a href="/search" class="nav-link">Search</a></li>
            <li><a href="/trending" class="nav-link active">Trending Movies</a></li>
            <li><a href="/quiz" class="nav-link">Quiz</a></li>
            <li><a href="/sentiment" class="nav-link">Sentiment Analysis</a></li>
            <li><a href="/face" class="nav-link">Face Detection</a></li>
        </ul>
    </div>
</nav>

<section class="page active">
    <div class="page-header">
        <h1>Top 10 Trending Ταινίες</h1>
        <p>Οι πιο δημοφιλείς ταινίες αυτή τη στιγμή από το API</p>
    </div>

    <div id="trendingResults" class="results-container"></div>
</section>

<footer class="site-footer">
    <div class="footer-container">
        <div class="footer-col footer-brand">
            <a href="/" class="logo-link" title="CineMatch">
                <img src="/logo.png" alt="CineMatch logo" class="logo-img footer-logo">
            </a>
            <p class="footer-tagline">Ανακάλυψε ταινίες με έξυπνες προτάσεις και μικρές περιγραφές.</p>
        </div>

        <div class="footer-col footer-nav">
            <h4 class="footer-title">Μενού</h4>
            <ul class="footer-menu">
                <li><a href="/" class="footer-link">Home</a></li>
                <li><a href="/search" class="footer-link">Search</a></li>
                <li><a href="/trending" class="footer-link">Trending Movies</a></li>
                <li><a href="/quiz" class="footer-link">Quiz</a></li>
                <li><a href="/sentiment" class="footer-link">Sentiment Analysis</a></li>
                <li><a href="/face" class="footer-link">Face Detection</a></li>
            </ul>
        </div>

        <div class="footer-col footer-social">
            <h4 class="footer-title">Ακολούθησέ μας</h4>
            <div class="social-links">
                <a href="https://facebook.com" class="social-link" aria-label="Facebook">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                        <path
                                d="M22 12.07C22 6.48 17.52 2 11.93 2S2 6.48 2 12.07c0 4.99 3.66 9.13 8.44 9.93v-7.03H7.9v-2.9h2.54V9.41c0-2.5 1.49-3.88 3.77-3.88 1.09 0 2.23.2 2.23.2v2.45h-1.25c-1.23 0-1.61.76-1.61 1.54v1.85h2.74l-.44 2.9h-2.3v7.03C18.34 21.2 22 17.06 22 12.07z"
                                fill="currentColor" />
                    </svg>
                    <span>Facebook</span>
                </a>
                <a href="https://instagram.com" class="social-link" aria-label="Instagram">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                        <path
                                d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5zm5 6.2A4.8 4.8 0 1 0 16.8 13 4.8 4.8 0 0 0 12 8.2zm6.5-3.7a1.1 1.1 0 1 0 1.1 1.1 1.1 1.1 0 0 0-1.1-1.1z"
                                fill="currentColor" />
                    </svg>
                    <span>Instagram</span>
                </a>
                <a href="https://twitter.com" class="social-link" aria-label="Twitter">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                        <path
                                d="M22 5.92c-.66.29-1.37.48-2.11.57a3.66 3.66 0 0 0 1.6-2.02 7.18 7.18 0 0 1-2.33.9A3.59 3.59 0 0 0 12.2 8.6c0 .28.03.56.09.83A10.2 10.2 0 0 1 3 5.16a3.57 3.57 0 0 0 1.11 4.78 3.5 3.5 0 0 1-1.62-.45v.05a3.6 3.6 0 0 0 2.88 3.52c-.47.13-.97.2-1.48.2-.36 0-.72-.03-1.06-.1a3.6 3.6 0 0 0 3.36 2.5A7.22 7.22 0 0 1 2 19.54 10.21 10.21 0 0 0 7.2 21c6.24 0 9.66-5.18 9.66-9.67v-.44c.66-.48 1.22-1.08 1.67-1.76a10.12 10.12 0 0 1-2.51.68z"
                                fill="currentColor" />
                    </svg>
                    <span>Twitter</span>
                </a>
            </div>
        </div>
    </div>

    <div class="footer-bottom">
        <div class="footer-container">
            <p class="small">&copy; <span id="year">2025</span> CineMatch — Όλα τα δικαιώματα διατηρούνται.</p>
            <p class="small muted">Σχεδιασμένο με ❤ για κινηματογραφόφιλους.</p>


            <a href="/TOU" class="footer-link" style="margin-top:10px; display:inline-block;">
                Όροι Χρήσης
            </a>
        </div>
    </div>

</footer>

<script>

    const results = document.getElementById("trendingResults");

    fetch("http://localhost:8080/api/trending")
        .then(response => response.json())
        .then(async (titles) => {
            if (!Array.isArray(titles) || titles.length === 0) {
                results.innerHTML = "<p class='error'>Δεν βρέθηκαν trending ταινίες.</p>";
                return;
            }

            const detailedMovies = await Promise.all(
                titles.map(async (title) => {
                    try {
                        const omdbRes = await fetch(`http://localhost:8080/api/movie/${encodeURIComponent(title)}`);
                        return await omdbRes.json();
                    } catch (err) {
                        console.log("OMDb error:", err);
                        return null;
                    }
                })
            );

            results.innerHTML = detailedMovies.map(movie => {
                if (!movie || movie.Response === "False") {
                    return `<div class="movie-card"><p>Σφάλμα φόρτωσης στοιχείων ταινίας.</p></div>`;
                }
                return `<div class="movie-card">
                <img src="${movie.Poster}" alt="Poster" class="poster-img">
                <div class="movie-info">
                    <h2>${movie.Title} (${movie.Year})</h2>
                    <p><strong>Ηθοποιοί:</strong> ${movie.Actors}</p>
                    <p><strong>Σκηνοθέτης:</strong> ${movie.Director}</p>
                    <p><strong>Είδος:</strong> ${movie.Genre}</p>
                    <p><strong>IMDB Rating:</strong> ⭐ ${movie.imdbRating}</p>
                    <p><strong>Πλοκή:</strong> ${movie.Plot}</p>
                </div>
            </div>`;
            }).join("");
        })
        .catch(err => {
            results.innerHTML = "<p class='error'>Σφάλμα επικοινωνίας με το backend!</p>";
            console.log(err);
        });


    (function updateFooterYear() {
        const y = new Date().getFullYear();
        const el = document.getElementById('year');
        if (el) el.textContent = y;
    })();

</script>

</body>

</html>